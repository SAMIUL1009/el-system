<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EL System</title>

<style>
body{
    font-family:Arial;
    background:#f2f2f2;
    margin:0;
    font-size:12px;
}
.box{
    max-width:420px;
    background:#fff;
    margin:10px auto;
    padding:8px;
    border:1.5px solid #000;
}
h2{text-align:center;font-size:15px;margin:6px 0;}
input,select,button{
    width:100%;
    padding:6px;
    margin:4px 0;
    font-size:12px;
}
button{
    background:#27ae60;
    color:white;
    border:none;
}
.blue{background:#2980b9;}
.red{background:#c0392b;}
.hide{display:none;}
.msg{color:red;text-align:center;}
.tab{display:flex;gap:5px;}
.tab button{width:50%;}
table{
    width:100%;
    border-collapse:collapse;
    margin-top:6px;
}
td,th{
    border:1px solid #000;
    padding:4px;
    text-align:center;
}
</style>
</head>

<body>

<div class="box">
<h2>EL System</h2>

<div class="tab">
    <button onclick="openTab('adminLogin')">Admin</button>
    <button onclick="openTab('worker')">Worker</button>
</div>

<!-- ADMIN LOGIN -->
<div id="adminLogin" class="hide">
    <h2>Admin Login</h2>
    <input type="password" id="adminPass" placeholder="Admin Password">
    <button onclick="loginAdmin()">Login</button>
    <p id="loginMsg" class="msg"></p>
</div>

<!-- ADMIN PANEL -->
<div id="adminPanel" class="hide">

<h2>Admin Panel</h2>

<select id="wid"></select>
<input id="total" value="24" placeholder="Total EL (Year)">
<button onclick="saveWorker()">Save Worker</button>

<hr>

<h2>Add Monthly EL</h2>
<select id="mid"></select>
<input id="month" placeholder="Month (e.g. Jan-2025)">
<input id="el" placeholder="EL Taken">
<button class="blue" onclick="addEL()">Save EL</button>

<hr>

<h2>Delete Wrong EL</h2>
<select id="delWid"></select>
<button onclick="loadWorkerEL()">Load EL</button>

<table>
<tr><th>Month</th><th>EL</th><th>Action</th></tr>
<tbody id="delRows"></tbody>
</table>

<p id="msg"></p>
</div>

<!-- WORKER PANEL -->
<div id="worker" class="hide">
<h2>Worker EL Status</h2>

<input id="widW" placeholder="Enter Worker ID">
<button onclick="viewEL()">View EL</button>

<div id="result" class="hide">
<table>
<tr><td>Name</td><td id="name"></td></tr>
<tr><td>ID</td><td id="widShow"></td></tr>
<tr><td>Total EL</td><td id="totalW"></td></tr>
<tr><td>Used EL</td><td id="used"></td></tr>
<tr><td><b>Remaining</b></td><td id="remain"></td></tr>
</table>

<table>
<tr><th>Month</th><th>EL</th></tr>
<tbody id="rows"></tbody>
</table>
</div>

<p id="msgW" class="msg"></p>
</div>

</div>

<script>
// ================= CONFIG =================
const ADMIN_PASSWORD = "1234";

// Default Workers
const defaultWorkers = {
 "700074":"RAKIBUL SK",
 "700087":"TUSHAR PAL",
 "700271":"AZIMUDDIN SK",
 "700274":"ARUP BHASKAR",
 "700278":"IMMAMUDDIN SK",
 "700279":"SHAFFIUDDIN SK",
 "700282":"BIDHAN CH. MONDAL",
 "700283":"ANUP MONDAL",
 "700284":"SAMJAN SK",
 "700286":"KAZI MASUD"
};

// ================= DATA =================
let workers = JSON.parse(localStorage.getItem("workers") || "{}");

for(let id in defaultWorkers){
    if(!workers[id]){
        workers[id]={name:defaultWorkers[id],total:24,months:{}};
    }
}
localStorage.setItem("workers",JSON.stringify(workers));

// ================= INIT =================
function loadDropdowns(){
    wid.innerHTML = mid.innerHTML = delWid.innerHTML = "";
    for(let id in workers){
        let t = id+" - "+workers[id].name;
        wid.innerHTML += `<option value="${id}">${t}</option>`;
        mid.innerHTML += `<option value="${id}">${t}</option>`;
        delWid.innerHTML += `<option value="${id}">${t}</option>`;
    }
}
loadDropdowns();

// ================= TAB =================
function openTab(t){
    adminLogin.classList.add("hide");
    adminPanel.classList.add("hide");
    worker.classList.add("hide");
    document.getElementById(t).classList.remove("hide");
}

// ================= ADMIN LOGIN =================
function loginAdmin(){
    if(adminPass.value===ADMIN_PASSWORD){
        adminLogin.classList.add("hide");
        adminPanel.classList.remove("hide");
        loginMsg.innerText="";
    }else{
        loginMsg.innerText="❌ Wrong Password";
    }
}

// ================= ADMIN FUNCTIONS =================
function saveWorker(){
    let id=wid.value;
    workers[id].total=Number(total.value)||0;
    localStorage.setItem("workers",JSON.stringify(workers));
    msg.innerText="✅ Worker Updated";
}

function addEL(){
    let id=mid.value;
    if(!month.value){alert("Month দিন");return;}
    workers[id].months[month.value]=Number(el.value)||0;
    localStorage.setItem("workers",JSON.stringify(workers));
    msg.innerText="✅ EL Added";
}

function loadWorkerEL(){
    let id=delWid.value;
    delRows.innerHTML="";
    for(let m in workers[id].months){
        delRows.innerHTML+=`
        <tr>
          <td>${m}</td>
          <td>${workers[id].months[m]}</td>
          <td><button class="red" onclick="deleteEL('${id}','${m}')">Delete</button></td>
        </tr>`;
    }
}

function deleteEL(id,month){
    if(!confirm("এই EL ডিলিট করবেন?"))return;
    delete workers[id].months[month];
    localStorage.setItem("workers",JSON.stringify(workers));
    loadWorkerEL();
    alert("✅ EL Deleted");
}

// ================= WORKER =================
function viewEL(){
    let id=widW.value.trim();
    let d=workers[id];
    if(!d){msgW.innerText="❌ ID Not Found";result.classList.add("hide");return;}

    msgW.innerText="";
    result.classList.remove("hide");

    let used=0;
    rows.innerHTML="";
    for(let m in d.months){
        used+=d.months[m];
        rows.innerHTML+=`<tr><td>${m}</td><td>${d.months[m]}</td></tr>`;
    }

    name.innerText=d.name;
    widShow.innerText=id;
    totalW.innerText=d.total;
    used.innerText=used;
    remain.innerText=d.total-used;
}
</script>

</body>
</html>